{% extends "base.html" %}

{% block title %}Setup Two-Factor Authentication{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
        <div class="card shadow-lg border-0 rounded-4">
            <div class="card-body p-4 p-md-5 text-center">
                <h2 class="card-title mb-4 fw-bold text-success">
                    <i class="fas fa-shield-virus me-2"></i>Secure Your Account with 2FA
                </h2>

                {% if qr_code %}
                    <p class="lead mb-4">Scan this QR code using an authenticator app like <strong>Google Authenticator</strong> or <strong>Authy</strong>.</p>
                    <div class="my-4">
                        <img src="{{ qr_code }}" alt="2FA QR Code" class="img-fluid border border-2 rounded shadow-sm" style="max-width: 250px;">
                    </div>
                    <p class="text-muted mb-4">After scanning, enter the 6-digit code generated by your app to verify and activate 2FA.</p>

                    <form method="POST" action="{{ url_for('auth.setup_2fa') }}" class="mt-4 needs-validation" novalidate>
                        <div class="mb-4 position-relative">
                            <label for="code" class="form-label visually-hidden">Verification Code</label>
                            <input type="text" class="form-control form-control-lg rounded-pill text-center shadow-sm border-1" id="code" name="code" placeholder="Enter 6-digit code" required pattern="\d{6}" maxlength="6" inputmode="numeric">
                            <div class="policy-box mt-2">
                                <i class="fas fa-check-circle text-success me-1"></i>Must be a 6-digit code from your app.
                            </div>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-success btn-lg rounded-pill btn-modern"><i class="fas fa-check-circle me-2"></i>Verify and Enable 2FA</button>
                        </div>
                    </form>
                {% else %}
                    <div class="alert alert-warning shadow-sm mt-4" role="alert">
                        <i class="fas fa-exclamation-circle me-2"></i>Could not generate QR code. Please try again or contact support.
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
